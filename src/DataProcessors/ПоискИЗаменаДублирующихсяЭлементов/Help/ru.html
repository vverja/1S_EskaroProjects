<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link href="v8help://service_book/service_style" type="text/css" rel="stylesheet"></link><meta content="MSHTML 6.00.2900.2963" name="GENERATOR"></meta></head><body>
<h1 class="">Обработка «Поиск и замена дублирующихся элементов справочников».</h1>
<p class="Usual"> </p>
<p class="Usual">Данная обработка позволяет выполнять поиск, замену и удаление дублирующихся элементов любого справочника.</p>
<p class="Usual">Поиск может выполняться в двух режимах:</p>
<menu><li>
<div class="">По равному значению реквизита,</div>
</li><li>
<div class="">По похожим словам</div></li></menu><p class="Usual">В первом режиме обработкой выполняется поиск элементов справочника, имеющих одинаковое значение заданного реквизита. Данный режим следует применять, когда равенство этих значений у элементов справочника с высокой вероятностью означает, что данные элементы дублируют друг друга. Например, для справочника «Контрагенты» это может быть реквизит «ИНН».</p>
<p class="Usual">Второй режим может применяться только для свойств и реквизитов строкового типа. В этом режиме выполняется поиск элементов справочников, имеющих похожие значения указанного реквизита. При этом выполняется как анализ входящих в значение отдельных слов (например, данный режим позволить найти такие элементы как «Пластинформ», «ООО Пластинформ», «Пластинформ ООО»),  так и побуквенное сравнение каждого слова (Иванов Иван Иванович, Иванов Иван Ивонович).</p>
<p class="Usual"> </p>
<p class="Usual"> </p>
<p class="Usual">Настройка параметров поиска выполняется на закладке <strong>«Настройка»</strong>.</p>
<p class="Usual">При этом обязательно следует указывать следующие параметры.</p>
<menu><li>
<div class="">Вид справочника,</div>
</li><li>
<div class="">Имя реквизита - необходимо выбрать реквизит, по значению которого будет выполняться анализ</div>
</li><li>
<div class="">Режим поиска - в каком режиме будет выполняться поиск (описано выше).</div></li></menu><p class="">Перечисленные выше поля являются обязательными для заполнения (отмечены другим цветом фона) - в противном случае обработка не выполнится. Кроме этого, в этом же списке также возможно выполнить ограничение отбираемых для анализа элементов справочника. Данное ограничение регулируется установкой отбора по значению любого реквизита справочника. При этом также возможен выбор типа сравнения значения реквизита со значением отбора. Например, данная возможность позволить отобрать и выполнить замену элементов с похожими наименованиями, входящих в одну и ту же группу справочника (отбор по значению поля «Родитель», тип сравнения «В иерархии»). </p>
<p class="">Кроме этого, при использовании режима поиска «по похожим словам», дополнительным параметром поиска является - «степень соответствия объектов». Значение данного параметра задается в отдельной форме настроек, вызываемой нажатием кнопки «Настройка» командной панели. Установка этого значения выполняется с помощью условной оценочной шкалы, имеющей крайние значения «Не отличаются» и «Значительно отличаются». Соответственно, при значении «Не отличаются» обработкой отбираются элементы, значения указанного реквизита которых отличаются только различным порядком слов в значении, например, «ЗАО ТД Нева» и «Нева ТД ЗАО». В случае установки значения параметра отличного от «Не отличаются» допускается как различия в составе слов значения («Свергуненко А.В., ИП» и «Свергуненко А.В»), так и различие в самих словах («Иванович» и «Ивонович»). Соответственно, в самом правом положении ползунка степень допустимого различия максимальна. По умолчанию значение данного параметра установлено как оптимальное для поиска, но в отдельных случаях может требовать изменения.</p>
<p class="">Запуск процедура поиска выполняется нажатием кнопки «Найти элементы».</p>
<p class="">Список найденных элементов отображается на закладке <strong>«Результаты поиска»</strong>. При этом потенциально дублирующиеся элементы разбиваются по отдельным группам. Выбор текущей группы для обработки выполняется с помощью выпадающего списка кнопки текущей группы, расположенной на командной панели. Причем, выводимый список элементов каждой группы возможно изменять - удалять элементы заведомо не являющиеся дублирующимися или, наоборот, вручную добавить элемент в список. (Данная возможность также позволяет не выполнять предшествующий поиск, а вручную заполнить весь список для последующей обработки, например, если никакими средствами получить желаемые результаты поиска не получается).</p>
<p class="">Для выполнения полной замены всех ссылок на дублирующие элементы на правильный элемент, необходимо указать обработке этот элемент, путем нажатия кнопки «Указать как правильный» командной панели. После выполнения данного действия выбранный элемент подсвечивается другим цветом фона. После чего нажать кнопку «Поиск ссылок». <strong>Поиск ссылок на объекты, их замена, а также последующее удаление выполняется только для элементов выбранной текущей группы. </strong></p>
<p class="">Результаты поиска ссылок на объекты отображаются на закладке <strong>«Замена»</strong>. После выполнения поиска нажатием кнопки «Выполнить замену» запускается замена всех ссылок на объекты на выбранный в предыдущем шаге правильный элемент.</p>
<p class="">Выполнение замены ссылок возможно выполнять в одной транзакции, путем установки флажка «Выполнять в транзакции». В этом случае замена будет произведена только для всех элементов одновременно. Любая неудачная попытка замены одной из ссылок отменит все сделанные до этого изменения в данных. При этом следует учитывать, что в некоторых случаях может сложиться ситуация, когда полностью автоматически замену выполнить не удастся. В таких случаях можно применять комбинированный подход - выполнять замену автоматически, после чего корректировать данные вручную, после чего опять запускать автоматическую замену. Соответственно, при таком подходе использование транзакции будет невозможным.</p>
<p class="">После того, как все ссылки на дублирующиеся элементы заменены на указанный правильный элемент (список найденных ссылок пуст) возможно выполнение процедуры непосредственного удаления этих элементов. Данная процедура запускается кнопкой «Удалить элементы». </p>
<p class="">После выполнения полного цикла поиска и замены элементов одной группы, возможен возврат на закладку «Результаты поиска» и выполнение данной процедуры уже для элементов другой группы. Повторного поиска похожих элементов выполнять не требуется.</p>
<p class=""><strong>ВАЖНО! При выполнении замены ссылок, контроля правильности устанавливаемых значений не выполняется. Также следует учитывать, что ссылки заменяются именно в том объекте, в котором они найдены. Например, если ссылка найдена в движениях документа, она будет заменена в наборе записей соответствующего регистра, сам документ при этом перепроводиться не будет! Кроме этого, необходимо помнить, что действия, выполняемые данной обработкой, являются необратимыми.</strong></p></body></html>